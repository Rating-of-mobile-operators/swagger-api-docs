openapi: 3.0.0

info:
  description: Api schema
  version: "1.0.0"
  title: API schema

security:
  - bearerAuth: []  

tags:
  - name: auth
    description: Работа с авторизацией
  - name: account
    description: Работа с аккаунтом<br>Работа с паролями/идентификаторами пользователя
  - name: profile
    description: Работа с профилем<br>Работа с публичной информацией пользователя
  - name: posts
    description: Работа с публикациями
  - name: likes
    description: Работа с \"Лайками\"
  - name: feeds
    description: Работа с лентой новостей
  - name: notifications
    description: Работа с уведомлениями
  - name: storage
    description: Работа с хранилищем сервиса
  - name: platform
    description: Работа с платформой

paths:
  /api/v1/auth/login:
    post:
      tags:
        - auth
      description: "Вход через логин/пароль"
      summary: "Вход через логин/пароль"
      requestBody:
        content:
          application/json:
            schema:
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "alex@example.com"
                password:
                  description: "Пароль"
                  example: "1234567890"
                  type: string
                  format: password
              required:
                - email
                - password
      responses:
        "200":
          description: "Успешный вход"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      allOf:
                      - $ref: "#/components/schemas/Person"
                      - $ref: "#/components/schemas/Token"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "Server error"
  /api/v1/auth/logout:
    post:
      tags:
        - auth
      description: "Выполнить выход"
      summary: "Выход"
      security:
        - bearerAuth: []
      responses:
        "200":
          description: "Успешная выход"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    
  
  /api/v1/account/register:
    post:
      tags:
        - account
      description: "Регистрация пользователя"
      summary: "Регистрация"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "arkady@example.com"
                passwd1:
                  type: string
                  description: "Пароль"
                  example: "123456"
                passwd2:
                  type: string
                  description: "Повтор пароля"
                  example: "123456"
                firstName:
                  type: string
                  description: "Имя"
                  example: "Аркадий"
                lastName:
                  type: string
                  description: "Фамилия"
                  example: "Паровозов"
                code:
                  type: string
                  description: "Код"
                  example: "3675"
      responses:
        "200":
          description: "Успешная регистрация"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
      
  /api/v1/account/password/recovery:
    put:
      tags: 
        - account
      description: "Восстановить пароль по email.<br>Высылает ссылку для восстановления на почтовый ящик."
      summary: "Восстановление пароля"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "alex@example.com"
      responses:
        "200":
          description: "Успешный запрос"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/account/password/set:
    put:
      tags: 
        - account
      description: "Изменить пароль."
      summary: "Смена пароля"
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  description: "Токен высланый на почтоый ящик. (Параметр используется в случае если пользователь восстанавливает пароль по почте)"
                  example: "ad1fj118f11"
                password:
                  type: string
                  description: "Новый пароль"
                  example: "123456"
      responses:
        "200":
          description: "Успешная смена пароля"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/account/notifications:
    put:
      tags: 
        - account
      description: "Редактирование настроек оповещения"
      summary: "Редактирование настроек оповещения"
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                notification_type:
                  $ref: "#/components/schemas/NotificationTypeCode"
                enable:
                  type: boolean
                  description: "Уведомлять о событиях данного типа"
                  example: true
      responses:
        "200":
          description: "Успешная смена статуса"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/users/me:
    get:
      tags:
        - profile
      description: "Получить текущего пользователя"
      security:
        - bearerAuth: []
      responses:
        '200':
          description: "Успешное получение текущего пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/Person"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - profile
      description: "Редактирование текущего пользователя"
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PersonEditBody"
      responses:
        '200':
          description: "Успешное получение текущего пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/Person"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - profile
      description: "Удаление текущего пользователя"
      security:
        - bearerAuth: []
      responses:
        '200':
          description: "Успешное удаление текущего пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      properties:
                        message:
                          type: string
                          description: "Сообщение о успехе"
                          example: "ok"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/users/{id}:
    get:
      tags:
        - profile
      description: "Получить пользователя по id"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID пользователя"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное получение пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/Person"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
 
  /api/v1/users/block/{id}:
    put:
      tags:
        - profile
      description: "Блокировка пользователя по id"
      summary: "Блокировка пользователя по id"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID пользователя"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешная блокировка пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - profile
      description: "Разблокировать пользователя по id"
      summary: "Разблокировать пользователя по id"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID пользователя"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное снятие блокировки с пользователя"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/post/:
    get:
      tags:
        - posts
      description: "Поиск публикации"
      summary: "Поиск публикации"
      security:
        - bearerAuth: []
      parameters:
      - name: text
        in: query
        description: "Текст публикации"
        required: true
        schema:
          type: string
          example: "Бла бла"
      - name: date_from
        in: query
        description: "Дата публикации ОТ"
        required: false
        schema:
          type: number
          example: 1559751301818
      - name: date_to
        in: query
        description: "Дата публикации ДО"
        required: false
        schema:
          type: number
          example: 1559751301818
      - $ref: '#/components/parameters/offsetParam'
      - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение публикации"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}:
    get:
      tags:
        - posts
      description: "Получение публикации по ID"
      summary: "Получение публикации по ID"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное получение публикации"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - posts
      description: "Редактирование публикации"
      summary: "Редактирование публикации по ID"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - name: publish_date
        in: query
        description: "Отложить до даты определенной даты"
        required: false
        schema:
          type: number
          example: 1559751301818
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostRequestBody'
      responses:
        '200':
          description: "Успешное редактирование публикации"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - posts
      description: "Удаление публикации"
      summary: "Удаление публикации по ID"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное удаление публикации"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        id:
                          type: number
                          description: "ID удаленной публикации"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}/recover:
    put:
      tags:
        - posts
      description: "Восстановление публикации по ID"
      summary: "Восстановление публикации по ID"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное восстановление публикации"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}/comments:
    get:
      tags:
        - posts
      description: "Получение комментариев на публикации"
      summary: "Получение комментариев на публикации"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - $ref: '#/components/parameters/offsetParam'
      - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение комментариев"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/Comment'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - posts
      description: "Создание комментария к публикации"
      summary: "Создание комментария к публикации"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentModel"
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/Comment"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}/comments/{comment_id}:
    put:
      tags:
        - posts
      description: "Редактирование комментария к публикации"
      summary: "Редактирование комментария к публикации"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - name: comment_id
        in: path
        description: "ID комментария публикации"
        required: true
        schema:
          type: number
          example: 1
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentModel"
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/Comment"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - posts
      description: "Удаление комментария к публикации"
      summary: "Удаление комментария к публикации"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - name: comment_id
        in: path
        description: "ID комментария публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        id:
                          type: number
                          description: "ID удаленной публикации"
                          example: 13
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}/comments/{comment_id}/recover:
    put:
      tags:
        - posts
      description: "Восстановление комментария"
      summary: "Восстановление комментария"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - name: comment_id
        in: path
        description: "ID комментария публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное восстановление комментария"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/Comment'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/post/{id}/report:
    post:
      tags:
        - posts
      description: "Подать жалобу на публикацию"
      summary: "Подать жалобу на публикацию"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      responses:
        '200':
          description: "Успешное создание жалобы на публикацию"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/post/{id}/comments/{comment_id}/report:
    post:
      tags:
        - posts
      description: "Подать жалобу на комментарий к публикации"
      summary: "Подать жалобу на комментарий к публикации"
      parameters:
      - name: id
        in: path
        description: "ID публикации"
        required: true
        schema:
          type: number
          example: 1
      - name: comment_id
        in: path
        description: "ID комментария"
        required: true
        schema:
          type: number
          example: 13
      responses:
        '200':
          description: "Успешное создание жалобы на комментарий"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        message:
                          type: string
                          example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
                
  /api/v1/liked:
    get:
      tags:
        - likes
      description: "Был ли поставлен лайк пользователем"
      summary: "Был ли поставлен лайк пользователем"
      security:
        - bearerAuth: []
      parameters: 
        - name: user_id
          in: query
          required: false
          description: "ID пользователя"
          schema:
            type: number
            example: 12
        - name: item_id
          in: query
          required: true
          description: "ID объекта у которого необходимо получить \"Лайки\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        likes:
                          type: boolean
                          example: false

        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/likes:
    get:
      tags:
        - likes
      description: "Получить список пользователей оставивших лайк"
      summary: "Получить список лайков"
      security:
        - bearerAuth: []
      parameters: 
        - name: item_id
          in: query
          required: true
          description: "ID объекта у которого необходимо получить \"Лайки\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/LikeUsersList"

        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - likes
      description: "Поставить лайк"
      summary: "Поставить лайк"
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LikeRequestBody"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: "#/components/schemas/LikeUsersList"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - likes
      description: "Убрать лайк"
      summary: "Убрать лайк"
      security:
        - bearerAuth: []
      parameters: 
        - name: item_id
          in: query
          required: true
          description: "ID объекта которому убирается \"Лайк\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        likes:
                          $ref: "#/components/schemas/LikesCount"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/feeds:
    get:
      tags:
        - feeds
      description: "Получение списка новостей"
      parameters:
        - name: name
          in: query
          description: "Текст новости для поиска"
          required: false
          schema:
            type: string
            example: "Бла бла"
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение списка новостей"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/notifications:
    get:
      tags:
        - notifications
      description: "Получить список уведомлений для текущего пользователя"
      summary: "Получить список уведомлений"
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение списка уведомлений"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/NotificationBase'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:  
      tags:
        - notifications
      description: "Отметить уведомление как \"прочитанное\""
      summary: "Прочитать уведомление"
      security:
        - bearerAuth: []
      parameters:
      - name: id
        in: query
        description: "ID уведомления"
        required: false
        schema:
          type: number
          example: 1
      - name: all
        in: query
        description: "Пометка что прочесть все уведомления"
        required: false
        schema:
          type: boolean
          example: true
        
      responses:
        "200":
          description: "Успешное получение списка уведомлений"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/NotificationBase'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/storage/:
    post:
      tags:
        - storage
      description: "Загрузка файла в хранилище"
      security:
        - bearerAuth: []
     
      responses:
        '200':
          description: "Успешная закгрузка файла"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/Response"
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/FileUploadResponse'
  /api/v1/platform/languages:
    get:
      tags:
        - platform
      description: "Получение языков платформы"
      summary: "Получение языков"
      parameters:
      - name: language
        in: query
        description: "Строка для поиска по языкам"
        required: false
        schema:
          type: string
      - $ref: '#/components/parameters/offsetParam'
      - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение языков"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/PlatfomLanguage'
  /api/v1/platform/countries:
    get:
      tags:
        - platform
      description: "Получение стран платформы"
      summary: "Получение стран"
      parameters:
      - name: country
        in: query
        description: "Строка для поиска по странам"
        required: false
        schema:
          type: string
      - $ref: '#/components/parameters/offsetParam'
      - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение стран"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/Country'
  /api/v1/platform/cities:
    get:
      tags:
        - platform
      description: "Получение городов платформы"
      summary: "Получение городов"
      parameters:
      - name: countryId
        in: query
        description: "ID страны"
        required: true
        schema:
          type: number
      - name: city
        in: query
        description: "Строка для поиска по городам"
        required: false
        schema:
          type: string
      - $ref: '#/components/parameters/offsetParam'
      - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение городов"
          content:
            application/json:
              schema:
                allOf:
                - $ref: "#/components/schemas/ListResponse"
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/City'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT  
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: "Тип ошибки"
          example: "invalid_request"
          enum:
            - invalid_request
            - unauthorized
        error_description:
          type: string
          items:
            $ref: '#/components/schemas/ErrorDescription'
    ErrorDescription:
      type: object
      properties:
        error_description:
          type: string
          description: "Error description"
          enum:
            - "Unauthorized"
            - "An authorization code must be supplied"
            - "Redirect URI mismatch"
            - "Invalid authorization code: CODE"
            - "Bad credentials"
    Response:
      type: object
      properties:
        error: 
          type: string
          description: "Сообщение, в случае ошибки здесь будет причина"
        timestamp:
          type: number
          example: 1559751301818
    ListResponse:
      allOf:
      - $ref: "#/components/schemas/Response"
      - type: object
        properties:
          total:
            type: integer
            description: "Количество элементов в списке"
            format: int64
          offset:
            type: integer
            description: "Отступ от начала списка"
            format: int64
          perPage:
            type: integer
            description: "Количество элементов на страницу"
            format: int64
            default: 20

    PersonEditBody:
      type: object
      description: "Пользователь соц. сети"
      properties:
        first_name:
          type: string
          example: "Петр"
        last_name:
          type: string
          example: "Петрович"
        birth_date:
          type: number
          example: 1559751301818
        phone:
          type: string
          example: '89100000000'
        photo_id:
          type: number
          description: "ID на фото в хранилище"
          example: "o1doj1d91j1d01d-1d1f"
        about:
          type: string
          example: "Родился в небольшой, но честной семье"
        town_id:
          type: number
          example: 123
        country_id:
          type: number
          example: 33
        messages_permission:
          type: string
          example: "ALL"
          description: "Разрешение на получение сообщений: ALL - от всех пользователей (кроме заблокированных), FRIENDS - только от друзей"
    Person:
      type: object
      description: "Пользователь соц. сети"
      properties:
        id:
          type: number
          example: 1
        first_name:
          type: string
          example: "Петр"
        last_name:
          type: string
          example: "Петрович"
        reg_date:
          type: number
          example: 1559751301818
        birth_date:
          type: number
          example: 1559751301818
        email:
          type: string
          example: "petr@mail.ru"
        phone:
          type: string
          example: '89100000000'
        photo:
          type: string
          example: "https://...../photos/image123.jpg"
        about:
          type: string
          example: "Родился в небольшой, но честной семье"
        city:
          $ref: "#/components/schemas/City"
        country:
          $ref: "#/components/schemas/Country"
        messages_permission:
          type: string
          example: "ALL"
          description: "Разрешение на получение сообщений: ALL - от всех пользователей (кроме заблокированных), FRIENDS - только от друзей"
        last_online_time:
          type: number
          example: 1559751301818
        is_blocked:
          type: boolean
          example: false
    BlockHistory:
      type: object
      description: "История блокировок пользователей за пост / комментарий"
      properties:
        id:
          type: number
          example: 1
        time:
          type: number
          example: 1559751301818
        person_id:
          type: number
          example: 1
        post_id:
          type: number
          example: 1
        comment_id:
          type: number
          example: 1
        action:
          type: string
          description: "Тип действия: BLOCK (блокировка) или UNBLOCK (разблокировка)"
    User:
      type: object
      description: "Модераторы и администраторы"
      properties:
        id:
          type: number
          example: 1
        name:
          type: string
        email:
          type: string
        type:
          type: string
          description: "Тип пользователя: MODERATOR, ADMIN (может управлять другими админами и модераторами)"
    Friendship:
      type: object
      description: "Дружба"
      properties:
        id:
          type: number
          example: 1
        status_id:
          type: number
          example: 13
          description: "Статус связи (см. ниже)"
        src_person_id:
          type: number
          example: 1
        dst_person_id:
          type: number
          example: 2
    FriendshipStatus:
      type: object
      description: "Статус дружбы"
      properties:
        id:
          type: number
          example: 13
        time:
          type: number
          example: 1559751301818
          description: "Дата и время установки данного статуса"
        name:
          type: string
        code:
          $ref: "#/components/schemas/FriendshipStatusCode"
    FriendshipStatusCode:
      description: "Код статуса статуса дружбы"
      type: string
      enum: 
        - FRIEND
        - REQUEST
        - BLOCKED
        - DECLINED
        - SUBSCRIBED
    Message:
      type: object
      description: "Личное сообщение"
      properties:
        id:
          type: number
          example: 12
        time:
          type: number
          description: "Дата и время отправки"
          format: date-time
          example: 1559751301818
        author_id:
          type: number
          example: 1
        recipient_id:
          type: number
          example: 1
        message_text:
          type: string
        read_status:
          $ref: "#/components/schemas/ReadStatus"
    MeasageSendRequestBody:
      type: object
      description: "Личное сообщение"
      properties:
        message_text:
          type: string
    LongpollServerResponseBody:
      type: object
      properties:
        key:
          type: string
          example: "0d8fd9459427ab0d481b9deddae3d5350e25f5ab"
        server:
          type: string
          description: "Url для подключения к longpoll серверу"
        ts:
          type: number
          example: 1614211035

    LongpollHistoryRequestBody:
      type: object
      properties:
        ts:
          type: number
          example: 1614211035
          description: "Последнее значение параметра ts, полученное от Long Poll сервера"
        pts:
          type: number
          description: "Последнее значение параметра new_pts, полученное от Long Poll сервера, используется для получения действий, которые хранятся всегда."
        preview_length:
          type: number
          description: "Количество символов, по которому нужно обрезать сообщение. Укажите 0, если Вы не хотите обрезать сообщение. (по умолчанию сообщения не обрезаются)."
        onlines:
          type: number
          description: "1 — возвращать в числе прочих события 8 и 9 (пользователь стал онлайн/оффлайн). Учитывается только при использовании ts."
        events_limit:
          type: number
          description: "Лимит по количеству всех событий в истории. Обратите внимание, параметры events_limit и msgs_limit применяются совместно. Число результатов в ответе ограничивается первым достигнутым лимитом."
        msgs_limit:
          type: number
          description: "Kимит по количеству событий с сообщениями в истории. Обратите внимание, параметры events_limit и msgs_limit применяются совместно. Число результатов в ответе ограничивается первым достигнутым лимитом."
        max_msg_id:
          type: number
          description: "Максимальный идентификатор сообщения среди уже имеющихся в локальной копии."
    LongpollHistoryResponse:
      type: object
      properties:
        messages:
          type: object
          properties:
            count:
              type: number
              example: 1
            messages:
              type: array
              items:
                $ref: '#/components/schemas/Message'
        profiles:
          type: array
          items:
            $ref: '#/components/schemas/Person'
            
    ReadStatus:
      type: string
      description: "Статус прочтения"
      enum:
        - SENT
        - READ
    PostRequestBody:
      type: object
      properties:
        title:
          type: string
          description: "Заголовок"
        post_text:
          type: string
          description: "HTML-текст поста"
    Post:
      type: object
      properties:
        id:
          type: number
          example: 1
        time:
          type: number
          example: 1559751301818
          description: "дата и время публикации"
        author:
          $ref: "#/components/schemas/Person"
            
        title:
          type: string
          description: "Заголовок"
        post_text:
          type: string
          description: "HTML-текст поста"
        is_blocked:
          type: boolean
          description: "Отметка о том, что пост заблокирован"
          example: false
        likes:
          type: number
          description: "Количество лайков"
          example: 23
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'
    PersonsWallPost:
      description: "Пост на стене пользователя"
      allOf:
        - $ref: "#/components/schemas/Post"
        - type: object
          properties:
            type:
              type: string
              enum:
                - POSTED
                - QUEUED
              example: "POSTED"
    Like:
      type: object
      description: "Лайки постов"
      properties:
        id:
          type: number
          example: 13
        time:
          type: number
          example: 1559751301818
        person_id:
          type: number
          example: 1
        post_id:
          type: number
          example: 11
    LikeRequestBody:
      type: object
      properties:
        item_id:
          type: number
          description: "ID объекта которому ставится \"Лайк\""
        type:
          $ref: "#/components/schemas/LikeType"
    LikeType:
      type: string
      description: "Тип объекта которому поставили лайк"
      example: "Post"
      enum:
        - Post
        - Comment
    LikesCount:
      type: string
      description: "Кол-во лайков"
      example: 1
    LikeUsersList:
      type: object
      properties:
        likes:
          $ref: "#/components/schemas/LikesCount"
        users:
          type: array
          description: "Пользователи поставившие лайк"
          items:
            type: string
            example: 1
    Attachment:
      type: object
      description: "Файлы, прикреплённые к постам"
      properties:
        id:
          type: number
          example: 11
        post_id:
          type: string
        name:
          type: string
        path:
          type: string
          description: "Путь к файлу в хранилище"
    CommentModel:
      type: object
      description: "Комментарий к посту"
      properties:
        parent_id:
          type: number
          example: 1
          description: "Родительский комментарий (если ответ на комментарий к посту)"
        comment_text:
          type: string
    Comment:
      type: object
      description: "Комментарий к посту"
      allOf:
        - $ref: "#/components/schemas/CommentModel"
        - type: object
          properties:
            id:
              type: number
              description: "Id комментария"
              example: 111
            post_id:
              type: string
            time:
              type: number
              example: 1559751301818
            author_id:
              type: number
              example: 1
            is_blocked:
              type: boolean
              description: "Комментарий заблокирован"
          
    NotificationBase:
      type: object
      description: "Оповещения"
      properties:
        id:
          type: number
          example: 1
        type_id:
          type: number
          example: 1
          description: "ID типа оповещения"
        sent_time:
          type: number
          example: 1559751301818
          description: "Время отправки"
        entity_id:
          type: number
          example: 1
          description: "Идентификатор сущности, относительно которой отправлено оповещение (комментарий, друг, пост или сообщение)"
        info:
          type: string
          description: "Текст уведомления"
    Notification:
      description: "Оповещения"
      allOf:
        - $ref: "#/components/schemas/NotificationBase"
        - type: object
          properties:
            person_id:
              type: number
              example: 1
              description: "Кому отправлено"
            contact:
              type: string
              description: "Куда отправлено оповещение (конкретный e-mail или телефон)"
    NotificationType:
      type: object
      properties:
        id:
          type: number
          example: 1
        code:
          $ref: "#/components/schemas/NotificationTypeCode"
        name:
          type: string
    NotificationTypeCode:
      type: string
      description: "Код типа уведомлений"
      enum:
        - POST
        - POST_COMMENT
        - COMMENT_COMMENT
        - FRIEND_REQUEST
        - MESSAGE
    Token:
      type: object
      description: "Token"
      properties:
        token:
          type: string
          description: "Token"
          example: "1q2e3e3r4t5"
    FileType:
      type: string
      description: "Тип файла"
      enum:
        - IMAGE
    FileUploadResponse:
      type: object
      description: "Загруженный файл"
      properties:
        id:
          type: string
        ownerId:
          type: number
          example: 12
          description: "ID владельца"
        fileName:
          type: string
          description: "Название файла"
        relativeFilePath: 
          type: string
          description: "Относительный путь до сжатого изображения"
        rawFileURL:
          type: string
          description: "Путь до исходного изрображения"
        fileFormat:
          type: string
          description: "Формат файла"
        bytes:
          type: number
          description: "Размер файла"
        fileType:
          $ref: "#/components/schemas/FileType"
        createdAt:
          type: number
          description: "Время загрузки файла на сервис"
    PlatfomLanguage: 
      type: object
      properties:
        id:
          type: number
          description: "Id языка"
          example: 1
        title:
          type: number
          description: "Язык"
          example: "Русский"
    Country:
      type: object
      properties:
        id:
          type: number
          description: "Id страны"
          example: 1
        title:
          type: string
          description: "Название страны"
          example: "Россия"
    City:
      type: object
      properties:
        id:
          type: number
          description: "Id города"
          example: 1
        title:
          type: string
          description: "Название города"
          example: "Москва"
  parameters:
    offsetParam:
      in: query
      description: "Отступ от начала списка"
      name: offset
      required: false
      schema:
        type: integer
        format: int64
    limitParam:
      in: query
      description: "Количество элементов на страницу"
      name: itemPerPage
      required: false
      schema:
        default: 20
        type: integer
        format: int64