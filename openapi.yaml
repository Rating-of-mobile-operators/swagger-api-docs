openapi: 3.0.0

info:
  description: Api schema
  version: "1.0.0"
  title: API schema

security:
  - bearerAuth: [ ]

tags:
  - name: auth
    description: Работа с авторизацией
  - name: account
    description: Работа с аккаунтом<br>Работа с паролями/идентификаторами пользователя
  - name: profile
    description: Работа с профилем<br>Работа с публичной информацией пользователя
  - name: reviews
    description: Работа с отзывами
  - name: likes
    description: Работа с \"Лайками\"
  - name: feeds
    description: Работа с лентой новостей
  - name: notifications
    description: Работа с уведомлениями
  - name: storage
    description: Работа с хранилищем сервиса
  - name: platform
    description: Работа с платформой

paths:
  /api/v1/auth/login:
    post:
      tags:
        - auth
      description: "Вход через логин/пароль"
      summary: "Вход через логин/пароль"
      requestBody:
        content:
          application/json:
            schema:
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "alex@example.com"
                password:
                  description: "Пароль"
                  example: "1234567890"
                  type: string
                  format: password
              required:
                - email
                - password
      responses:
        "200":
          description: "Успешный вход"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "Server error"
  /api/v1/auth/logout:
    post:
      tags:
        - auth
      description: "Выполнить выход"
      summary: "Выход"
      security:
        - bearerAuth: [ ]
      responses:
        "200":
          description: "Успешная выход"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  
  /api/v1/account/register:
    post:
      tags:
        - account
      description: "Регистрация пользователя"
      summary: "Регистрация"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "arkady@example.com"
                passwd1:
                  type: string
                  description: "Пароль"
                  example: "123456"
                passwd2:
                  type: string
                  description: "Повтор пароля"
                  example: "123456"
                firstName:
                  type: string
                  description: "Имя"
                  example: "Аркадий"
                lastName:
                  type: string
                  description: "Фамилия"
                  example: "Паровозов"
                code:
                  type: string
                  description: "Код"
                  example: "3675"
      responses:
        "200":
          description: "Успешная регистрация"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/account/password/recovery:
    put:
      tags:
        - account
      description: "Восстановить пароль по email.<br>Высылает ссылку для восстановления на почтовый ящик."
      summary: "Восстановление пароля"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: "E-Mail"
                  example: "alex@example.com"
      responses:
        "200":
          description: "Успешный запрос"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/account/password/set:
    put:
      tags:
        - account
      description: "Изменить пароль."
      summary: "Смена пароля"
      security:
        - bearerAuth: [ ]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  description: "Токен высланый на почтоый ящик. (Параметр используется в случае если пользователь восстанавливает пароль по почте)"
                  example: "ad1fj118f11"
                password:
                  type: string
                  description: "Новый пароль"
                  example: "123456"
      responses:
        "200":
          description: "Успешная смена пароля"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/account/notifications:
    put:
      tags:
        - account
      description: "Редактирование настроек оповещения"
      summary: "Редактирование настроек оповещения"
      security:
        - bearerAuth: [ ]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                notification_type:
                  $ref: "#/components/schemas/NotificationTypeCode"
                enable:
                  type: boolean
                  description: "Уведомлять о событиях данного типа"
                  example: true
      responses:
        "200":
          description: "Успешная смена статуса"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    example: "ok"
        '400':
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/users/me:
    get:
      tags:
        - profile
      description: "Получить текущего пользователя"
      security:
        - bearerAuth: [ ]
      responses:
        '200':
          description: "Успешное получение текущего пользователя"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - profile
      description: "Редактирование текущего пользователя"
      security:
        - bearerAuth: [ ]
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PersonEditBody"
      responses:
        '200':
          description: "Успешное получение текущего пользователя"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - profile
      description: "Удаление текущего пользователя"
      security:
        - bearerAuth: [ ]
      responses:
        '200':
          description: "Успешное удаление текущего пользователя"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    description: "Сообщение о успехе"
                    example: "ok"
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/users/{id}:
    get:
      tags:
        - profile
      description: "Получить пользователя по id"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID пользователя"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное получение пользователя"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Person"

  /api/v1/users/block/{id}:
    put:
      tags:
        - profile
      description: "Блокировка пользователя по id"
      summary: "Блокировка пользователя по id"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID пользователя"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешная блокировка пользователя"
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    description: "Сообщение о успехе"
                    example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - profile
      description: "Разблокировать пользователя по id"
      summary: "Разблокировать пользователя по id"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID пользователя"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное снятие блокировки с пользователя"
          content:
            application/json:
              schema:

                type: object
                properties:
                  message:
                    type: string
                    example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/reviews/:
    get:
      tags:
        - reviews
      description: "Поиск последних отзывов"
      summary: "Поиск последних отзывов"
      security:
        - bearerAuth: [ ]
      parameters:
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение публикации"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}:
    get:
      tags:
        - reviews
      description: "Получение отзыва по ID"
      summary: "Получение отзыва по ID"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID отзыва"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное получение отзыва"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Review'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - reviews
      description: "Редактирование отзыва"
      summary: "Редактирование отзыва по ID"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID отзыва"
          required: true
          schema:
            type: number
            example: 1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostRequestBody'
      responses:
        '200':
          description: "Успешное редактирование отзыва"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - reviews
      description: "Удаление публикации"
      summary: "Удаление публикации по ID"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное удаление публикации"
          content:
            application/json:
              schema:

                type: object
                properties:
                  id:
                    type: number
                    description: "ID удаленной публикации"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}/recover:
    put:
      tags:
        - reviews
      description: "Восстановление публикации по ID"
      summary: "Восстановление публикации по ID"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное восстановление публикации"
          content:
            application/json:
              schema:

                $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}/comments:
    get:
      tags:
        - reviews
      description: "Получение комментариев у оператора"
      summary: "Получение комментариев у оператора"
      parameters:
        - name: id
          in: path
          description: "ID оператора"
          required: true
          schema:
            type: number
            example: 1
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение комментариев"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Comment'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - reviews
      description: "Создание комментария к публикации"
      summary: "Создание комментария к публикации"
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentModel"
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/Comment"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}/comments/{comment_id}:
    put:
      tags:
        - reviews
      description: "Редактирование комментария к публикации"
      summary: "Редактирование комментария к публикации"
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
        - name: comment_id
          in: path
          description: "ID комментария публикации"
          required: true
          schema:
            type: number
            example: 1
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentModel"
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/Comment"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - reviews
      description: "Удаление комментария к публикации"
      summary: "Удаление комментария к публикации"
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
        - name: comment_id
          in: path
          description: "ID комментария публикации"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное создание комментария"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: number
                            description: "ID удаленной публикации"
                            example: 13
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}/comments/{comment_id}/recover:
    put:
      tags:
        - reviews
      description: "Восстановление комментария"
      summary: "Восстановление комментария"
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
        - name: comment_id
          in: path
          description: "ID комментария публикации"
          required: true
          schema:
            type: number
            example: 1
      responses:
        '200':
          description: "Успешное восстановление комментария"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Comment'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/reviews/{id}/comments/{comment_id}/report:
    post:
      tags:
        - reviews
      description: "Подать жалобу на комментарий к публикации"
      summary: "Подать жалобу на комментарий к публикации"
      parameters:
        - name: id
          in: path
          description: "ID публикации"
          required: true
          schema:
            type: number
            example: 1
        - name: comment_id
          in: path
          description: "ID комментария"
          required: true
          schema:
            type: number
            example: 13
      responses:
        '200':
          description: "Успешное создание жалобы на комментарий"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          message:
                            type: string
                            example: "ok"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/liked:
    get:
      tags:
        - likes
      description: "Был ли поставлен лайк пользователем"
      summary: "Был ли поставлен лайк пользователем"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: user_id
          in: query
          required: false
          description: "ID пользователя"
          schema:
            type: number
            example: 12
        - name: item_id
          in: query
          required: true
          description: "ID объекта у которого необходимо получить \"Лайки\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          likes:
                            type: boolean
                            example: false

        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/likes:
    get:
      tags:
        - likes
      description: "Получить список пользователей оставивших лайк"
      summary: "Получить список лайков"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: item_id
          in: query
          required: true
          description: "ID объекта у которого необходимо получить \"Лайки\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/LikeUsersList"

        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - likes
      description: "Поставить лайк"
      summary: "Поставить лайк"
      security:
        - bearerAuth: [ ]
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LikeRequestBody"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/LikeUsersList"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - likes
      description: "Убрать лайк"
      summary: "Убрать лайк"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: item_id
          in: query
          required: true
          description: "ID объекта которому убирается \"Лайк\""
          schema:
            type: number
            example: 42
        - name: type
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/LikeType"
      responses:
        "200":
          description: "Успешно"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          likes:
                            $ref: "#/components/schemas/LikesCount"
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/feeds:
    get:
      tags:
        - feeds
      description: "Получение списка новостей"
      parameters:
        - name: name
          in: query
          description: "Текст новости для поиска"
          required: false
          schema:
            type: string
            example: "Бла бла"
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        '200':
          description: "Успешное получение списка новостей"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Post'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/notifications:
    get:
      tags:
        - notifications
      description: "Получить список уведомлений для текущего пользователя"
      summary: "Получить список уведомлений"
      security:
        - bearerAuth: [ ]
      parameters:
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение списка уведомлений"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/NotificationBase'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - notifications
      description: "Отметить уведомление как \"прочитанное\""
      summary: "Прочитать уведомление"
      security:
        - bearerAuth: [ ]
      parameters:
        - name: id
          in: query
          description: "ID уведомления"
          required: false
          schema:
            type: number
            example: 1
        - name: all
          in: query
          description: "Пометка что прочесть все уведомления"
          required: false
          schema:
            type: boolean
            example: true

      responses:
        "200":
          description: "Успешное получение списка уведомлений"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/NotificationBase'
        "400":
          description: "Bad Request"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "unauthorized"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/storage/:
    post:
      tags:
        - storage
      description: "Загрузка файла в хранилище"
      security:
        - bearerAuth: [ ]

      responses:
        '200':
          description: "Успешная закгрузка файла"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Response"
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/FileUploadResponse'
  /api/v1/platform/languages:
    get:
      tags:
        - platform
      description: "Получение языков платформы"
      summary: "Получение языков"
      parameters:
        - name: language
          in: query
          description: "Строка для поиска по языкам"
          required: false
          schema:
            type: string
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение языков"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/PlatfomLanguage'
  /api/v1/platform/countries:
    get:
      tags:
        - platform
      description: "Получение стран платформы"
      summary: "Получение стран"
      parameters:
        - name: country
          in: query
          description: "Строка для поиска по странам"
          required: false
          schema:
            type: string
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение стран"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Country'
  /api/v1/platform/cities:
    get:
      tags:
        - platform
      description: "Получение городов платформы"
      summary: "Получение городов"
      parameters:
        - name: countryId
          in: query
          description: "ID страны"
          required: true
          schema:
            type: number
        - name: city
          in: query
          description: "Строка для поиска по городам"
          required: false
          schema:
            type: string
        - $ref: '#/components/parameters/offsetParam'
        - $ref: '#/components/parameters/limitParam'
      responses:
        "200":
          description: "Успешное получение городов"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/City'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:

    Error:
      type: object
      properties:
        error:
          type: string
          description: "Тип ошибки"
          example: "invalid_request"
          enum:
            - invalid_request
            - unauthorized
        error_description:
          type: string
          items:
            $ref: '#/components/schemas/ErrorDescription'
    ErrorDescription:
      type: object
      properties:
        error_description:
          type: string
          description: "Error description"
          enum:
            - "Unauthorized"
            - "An authorization code must be supplied"
            - "Redirect URI mismatch"
            - "Invalid authorization code: CODE"
            - "Bad credentials"

    ListResponse:
      allOf:
        - type: object
          properties:
            total:
              type: integer
              description: "Количество элементов в списке"
              format: int64
            offset:
              type: integer
              description: "Отступ от начала списка"
              format: int64
            perPage:
              type: integer
              description: "Количество элементов на страницу"
              format: int64
              default: 20


    Review:
      type: object
      properties:
        id:
          type: number
          example: 1
        time:
          type: number
          example: 1559751301818
          description: "дата и время публикации"
        author:
          $ref: "#/components/schemas/Person"
        title:
          type: string
          description: "Заголовок"
        operator_id:
          type: number
          example: 1
          description: "ID Оператора"
        review_text:
          type: string
          description: "HTML-текст поста"
        is_blocked:
          type: boolean
          description: "Отметка о том, что отзыв заблокирован"
          example: false
        is_deleted:
          type: boolean
          description: "Отметка о том, что отзыв удалён"
          example: false
        likes:
          type: number
          description: "Количество лайков"
          example: 23
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'

    PersonEditBody:
      type: object
      description: "Пользователь соц. сети"
      properties:
        first_name:
          type: string
          example: "Петр"
        birth_date:
          type: number
          example: 1559751301818
        phone:
          type: string
          example: '89100000000'
        photo_id:
          type: number
          description: "ID на фото в хранилище"
          example: "o1doj1d91j1d01d-1d1f"
        about:
          type: string
          example: "Родился в небольшой, но честной семье"
        town_id:
          type: number
          example: 123
        country_id:
          type: number
          example: 33

    Person:
      type: object
      description: "Пользователь соц. сети"
      properties:
        id:
          type: number
          example: 1
        first_name:
          type: string
          example: "Петр"
        reg_date:
          type: number
          example: 1559751301818
        birth_date:
          type: number
          example: 1559751301818
        email:
          type: string
          example: "petr@mail.ru"
        phone:
          type: string
          example: '89100000000'
        photo:
          type: string
          example: "https://...../photos/image123.jpg"
        about:
          type: string
          example: "Родился в небольшой, но честной семье"
        city:
          $ref: "#/components/schemas/City"
        country:
          $ref: "#/components/schemas/Country"
        is_can_write:
          type: boolean
          example: false
        is_blocked:
          type: boolean
          example: false
    User:
      type: object
      description: "Модераторы и администраторы"
      properties:
        id:
          type: number
          example: 1
        name:
          type: string
        email:
          type: string
        type:
          type: string
          description: "Тип пользователя: MODERATOR, ADMIN (может управлять другими админами и модераторами)"

    PostRequestBody:
      type: object
      properties:
        title:
          type: string
          description: "Заголовок"
        review_text:
          type: string
          description: "HTML-текст поста"
    Post:
      type: object
      properties:
        id:
          type: number
          example: 1
        time:
          type: number
          example: 1559751301818
          description: "дата и время публикации"
        author:
          $ref: "#/components/schemas/Person"

        title:
          type: string
          description: "Заголовок"
        post_text:
          type: string
          description: "HTML-текст поста"
        is_blocked:
          type: boolean
          description: "Отметка о том, что пост заблокирован"
          example: false
        likes:
          type: number
          description: "Количество лайков"
          example: 23
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'
    PersonsWallPost:
      description: "Пост на стене пользователя"
      allOf:
        - $ref: "#/components/schemas/Post"
        - type: object
          properties:
            type:
              type: string
              enum:
                - POSTED
                - QUEUED
              example: "POSTED"
    Like:
      type: object
      description: "Лайки постов"
      properties:
        id:
          type: number
          example: 13
        time:
          type: number
          example: 1559751301818
        person_id:
          type: number
          example: 1
        post_id:
          type: number
          example: 11
    LikeRequestBody:
      type: object
      properties:
        item_id:
          type: number
          description: "ID объекта которому ставится \"Лайк\""
        type:
          $ref: "#/components/schemas/LikeType"
    LikeType:
      type: string
      description: "Тип объекта которому поставили лайк"
      example: "Post"
      enum:
        - Post
        - Comment
    LikesCount:
      type: string
      description: "Кол-во лайков"
      example: 1
    LikeUsersList:
      type: object
      properties:
        likes:
          $ref: "#/components/schemas/LikesCount"
        users:
          type: array
          description: "Пользователи поставившие лайк"
          items:
            type: string
            example: 1
    Attachment:
      type: object
      description: "Файлы, прикреплённые к постам"
      properties:
        id:
          type: number
          example: 11
        post_id:
          type: string
        name:
          type: string
        path:
          type: string
          description: "Путь к файлу в хранилище"
    CommentModel:
      type: object
      description: "Комментарий к посту"
      properties:
        parent_id:
          type: number
          example: 1
          description: "Родительский комментарий (если ответ на комментарий к посту)"
        comment_text:
          type: string
    Comment:
      type: object
      description: "Комментарий к оператору"
      allOf:
        - $ref: "#/components/schemas/CommentModel"
        - type: object
          properties:
            id:
              type: number
              description: "Id комментария"
              example: 111
            operator_id:
              type: number
              example: 1
            time:
              type: number
              example: 1559751301818
            author_id:
              type: number
              example: 1
            is_blocked:
              type: boolean
              description: "Комментарий заблокирован"
            is_deleted:
              type: boolean
              description: "Комментарий удалён"

    NotificationBase:
      type: object
      description: "Оповещения"
      properties:
        id:
          type: number
          example: 1
        type_id:
          type: number
          example: 1
          description: "ID типа оповещения"
        sent_time:
          type: number
          example: 1559751301818
          description: "Время отправки"
        entity_id:
          type: number
          example: 1
          description: "Идентификатор сущности, относительно которой отправлено оповещение (комментарий, друг, пост или сообщение)"
        info:
          type: string
          description: "Текст уведомления"
    NotificationTypeCode:
      type: string
      description: "Код типа уведомлений"
      enum:
        - POST
        - POST_COMMENT
        - COMMENT_COMMENT
        - FRIEND_REQUEST
        - MESSAGE
    FileType:
      type: string
      description: "Тип файла"
      enum:
        - IMAGE
    FileUploadResponse:
      type: object
      description: "Загруженный файл"
      properties:
        id:
          type: string
        ownerId:
          type: number
          example: 12
          description: "ID владельца"
        fileName:
          type: string
          description: "Название файла"
        relativeFilePath:
          type: string
          description: "Относительный путь до сжатого изображения"
        rawFileURL:
          type: string
          description: "Путь до исходного изрображения"
        fileFormat:
          type: string
          description: "Формат файла"
        bytes:
          type: number
          description: "Размер файла"
        fileType:
          $ref: "#/components/schemas/FileType"
        createdAt:
          type: number
          description: "Время загрузки файла на сервис"
    PlatfomLanguage:
      type: object
      properties:
        id:
          type: number
          description: "Id языка"
          example: 1
        title:
          type: number
          description: "Язык"
          example: "Русский"
    Country:
      type: object
      properties:
        id:
          type: number
          description: "Id страны"
          example: 1
        title:
          type: string
          description: "Название страны"
          example: "Россия"
    City:
      type: object
      properties:
        id:
          type: number
          description: "Id города"
          example: 1
        title:
          type: string
          description: "Название города"
          example: "Москва"
  parameters:
    offsetParam:
      in: query
      description: "Отступ от начала списка"
      name: offset
      required: false
      schema:
        type: integer
        format: int64
    limitParam:
      in: query
      description: "Количество элементов на страницу"
      name: itemPerPage
      required: false
      schema:
        default: 20
        type: integer
        format: int64